# Notion 数据熵增指标设计

## 一、可用数据源

通过 Notion API 可以获取的数据：

| 数据 | API 端点 | 说明 |
|-----|---------|------|
| 页面元数据 | `search` / `databases.query` | last_edited_time, created_time, properties |
| 数据库结构 | `databases.retrieve` | 属性定义、关联关系 |
| 页面内容 | `blocks.children.list` | blocks, mentions, links（需额外请求） |
| 页面属性 | 包含在页面数据中 | title, select, relation 等 |

## 二、推荐的熵增指标

### 2.1 时间维度指标

#### ✅ 时间衰减熵 (Time Decay Entropy)
- **定义**：超过 N 天未更新的页面占比
- **公式**：`outdated_pages / total_pages * 100%`
- **阈值建议**：30天，警告阈值 40%
- **意义**：反映信息的"新鲜度"，过期信息堆积程度

#### 📊 创建-更新活跃度 (Creation-Update Activity)
- **定义**：最近 N 天内创建或更新的页面数量
- **意义**：反映知识库的活跃程度
- **计算**：
  - 近7天活跃页面数
  - 近30天活跃页面数
  - 活跃率 = 活跃页面 / 总页面

#### 📈 内容增长率 (Content Growth Rate)
- **定义**：每月新增页面数量趋势
- **意义**：判断知识库是在增长还是停滞

### 2.2 结构维度指标

#### 🔗 连接密度 (Link Density)
- **定义**：页面中包含链接（mention/relation）的比例
- **实现方式**：
  1. 检查 relation 属性（低成本）
  2. 抽样检查页面内容中的 mention（中等成本）
- **意义**：知识网络的连通程度

#### 📁 属性完整度 (Property Completeness)
- **定义**：页面属性的填写完整程度
- **公式**：`filled_properties / total_properties * 100%`
- **意义**：信息的结构化程度

#### 🏷️ 分类覆盖率 (Categorization Coverage)
- **定义**：有标签/分类的页面占比
- **检查属性**：select, multi_select, relation 等
- **意义**：信息组织的规范程度

### 2.3 内容质量指标

#### 📄 空页面率 (Empty Page Rate)
- **定义**：没有内容的页面占比
- **实现**：抽样检查 blocks 数量
- **意义**：废弃/未完成内容的占比

#### 📝 内容长度分布 (Content Length Distribution)
- **定义**：页面 blocks 数量的分布
- **意义**：识别过于简短或过于冗长的页面

### 2.4 综合健康度指标

#### 🏥 知识库健康度 (Knowledge Base Health Score)
- **综合评分公式**：
  ```
  健康度 = (1 - 时间衰减熵/100) × 0.4 
         + 活跃率 × 0.3 
         + 属性完整度 × 0.2 
         + 分类覆盖率 × 0.1
  ```
- **评级**：
  - 80-100%: 健康
  - 60-80%: 一般
  - 40-60%: 需要整理
  - 0-40%: 混乱

## 三、指标优先级

考虑到 API 调用成本和实用性，建议按以下优先级实现：

### 第一优先级（低成本，高价值）
1. ✅ 时间衰减熵（已实现）
2. 🆕 活跃度指标（近期活跃页面统计）
3. 🆕 属性完整度
4. 🆕 分类覆盖率

### 第二优先级（中等成本）
5. 🆕 连接密度（抽样检测 mention）
6. 🆕 空页面率（抽样检测）

### 第三优先级（高成本）
7. 内容长度分布
8. 完整的链接图分析

## 四、实现建议

### 抽样策略
- 对于需要额外 API 调用的指标（如检测 mention），采用抽样方式
- 默认抽样比例：10%（可配置）
- 抽样方法：随机抽样

### 速率限制处理
- Notion API 速率限制：约 3 请求/秒
- 添加请求间隔和重试机制
- 大型知识库考虑分批处理

## 五、指标解读

| 指标 | 健康范围 | 警告范围 | 危险范围 |
|-----|---------|---------|---------|
| 时间衰减熵 | < 30% | 30-50% | > 50% |
| 活跃率（30天） | > 20% | 10-20% | < 10% |
| 属性完整度 | > 70% | 50-70% | < 50% |
| 分类覆盖率 | > 80% | 60-80% | < 60% |
| 空页面率 | < 5% | 5-15% | > 15% |
| 连接密度 | > 30% | 15-30% | < 15% |

